<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>8 Ps Case Conceptualization Practice</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7fafc;
      margin: 40px;
    }
    .container {
      max-width: 700px;
      margin: auto;
      padding: 32px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 0 18px rgba(180,180,200,0.1);
    }
    h1 {
      color: #37517e;
      margin-bottom: 0.3em;
    }
    .scenario {
      font-style: italic;
      background: #f0f4f8;
      padding: 14px;
      border-radius: 6px;
      margin-bottom: 16px;
    }
    .p-section {
      margin-bottom: 20px;
    }
    label {
      font-weight: bold;
    }
    textarea {
      width: 100%;
      min-height: 45px;
      margin-top: 7px;
      border: 1px solid #b6b9bb;
      border-radius: 5px;
      font-size: 1em;
      padding: 6px;
    }
    button {
      background: #37517e;
      color: #fff;
      padding: 12px 28px;
      border: none;
      border-radius: 7px;
      cursor: pointer;
      font-size: 1em;
      transition: background 0.2s;
    }
    button:hover {
      background: #4669a5;
    }
    .feedback {
      margin-top: 24px;
      padding: 12px;
      background: #eaf7ea;
      border-radius: 8px;
    }
    .hidden {
      display: none;
    }
    .ps-explain {
      color: #37517e;
      font-size: 0.95em;
      margin-bottom: 7px;
    }
    #randomize {
      margin-bottom: 20px;
      background: #8ece8e;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>8 Ps Case Conceptualization Practice</h1>
    <button id="randomize">Randomize Scenario</button>
    <div class="scenario" id="scenarioBox"></div>
    <form id="conceptForm">
      <div class="p-section">
        <label for="presenting">1. Presenting Problem</label>
        <p class="ps-explain">What primary concern has brought the client to counseling?</p>
        <textarea id="presenting" required></textarea>
      </div>
      <div class="p-section">
        <label for="predisposing">2. Predisposing Factors</label>
        <p class="ps-explain">Which factors might make the client more vulnerable to the presenting problem?</p>
        <textarea id="predisposing" required></textarea>
      </div>
      <div class="p-section">
        <label for="precipitating">3. Precipitating Factors</label>
        <p class="ps-explain">What recent events or triggers have contributed to the problem's onset?</p>
        <textarea id="precipitating" required></textarea>
      </div>
      <div class="p-section">
        <label for="perpetuating">4. Perpetuating Factors</label>
        <p class="ps-explain">What keeps the problem going or makes it worse?</p>
        <textarea id="perpetuating" required></textarea>
      </div>
      <div class="p-section">
        <label for="protective">5. Protective Factors</label>
        <p class="ps-explain">What strengths/resources might help the client?</p>
        <textarea id="protective" required></textarea>
      </div>
      <div class="p-section">
        <label for="prognosis">6. Prognosis</label>
        <p class="ps-explain">What is the likely course or outcome for this client?</p>
        <textarea id="prognosis" required></textarea>
      </div>
      <div class="p-section">
        <label for="plan">7. Plan</label>
        <p class="ps-explain">What are the initial steps in the treatment plan?</p>
        <textarea id="plan" required></textarea>
      </div>
      <div class="p-section">
        <label for="personality">8. Personality</label>
        <p class="ps-explain">What aspects of the client's personality are relevant?</p>
        <textarea id="personality" required></textarea>
      </div>
      <button type="submit">Submit Responses</button>
    </form>
    <div id="feedback" class="feedback hidden"></div>
  </div>

  <script>
    // Scenario pool for randomization (add more as needed)
    const scenarios = [
      {
        text: "Jordan, a 24-year-old graduate student, presents to counseling with feelings of chronic anxiety, difficulties sleeping, and recent social withdrawal. Jordan reports the anxiety started after a demanding internship began three months ago, and mentions a family history of anxiety disorders. Jordan's support system is limited due to recently moving away from home.",
        keys: {
          presenting: ["anxiety", "difficulties sleeping", "social withdrawal"],
          predisposing: ["family history of anxiety", "recent move", "limited support system"],
          precipitating: ["demanding internship", "three months ago"],
          perpetuating: ["ongoing stress", "limited support system", "isolation"],
          protective: ["motivation for help", "youth", "willingness to seek counseling"],
          prognosis: ["good with support", "depends on intervention"],
          plan: ["increase support", "address anxiety", "teach coping skills", "improve sleep"],
          personality: ["conscientious", "introverted"]
        }
      },
      {
        text: "Emma, a 32-year-old woman, seeks therapy for sadness, anxiety about her future, and withdrawal from social activities. Her problems were exacerbated by a recent breakup and job loss. Emma also has a family history of depression and lacked emotional support growing up.",
        keys: {
          presenting: ["sadness", "anxiety", "withdrawal", "low self-esteem"],
          predisposing: ["family history of depression", "lack of support as a child", "dysfunctional household"],
          precipitating: ["breakup", "job loss"],
          perpetuating: ["negative thoughts", "poor coping", "lack of support system", "unemployment"],
          protective: ["close friend", "previous resilience", "education"],
          prognosis: ["favorable with support", "good engagement in therapy"],
          plan: ["CBT", "enhance coping", "expand support system", "job resources"],
          personality: ["resilient", "self-critical"]
        }
      },
      {
        text: "Carlos, a 16-year-old high school student, is referred by his teacher due to frequent absences and a decline in grades. Carlos shares that after his parents' recent divorce, he has been feeling hopeless and spends most of his time gaming and avoiding schoolwork.",
        keys: {
          presenting: ["frequent absences", "decline in grades", "hopelessness"],
          predisposing: ["parents' divorce", "strained family relationships"],
          precipitating: ["recent divorce"],
          perpetuating: ["avoidance", "excess gaming", "lack of motivation"],
          protective: ["youth", "academic potential", "access to school counseling"],
          prognosis: ["improves with support", "risk if issues unaddressed"],
          plan: ["family therapy", "motivation building", "monitor attendance", "engage extracurriculars"],
          personality: ["introverted", "sensitive"]
        }
      }
      // Add more diverse scenarios here
    ];

    // More detailed feedback for learning
    function buildFeedback(pKey, userInput, answerKey) {
      let input = userInput.toLowerCase();
      let feedback = "";
      let matchCount = 0;
      answerKey.forEach(key => {
        if (input.includes(key)) matchCount++;
      });
      if (matchCount > 0) {
        feedback += `Great job! You included ${matchCount} key element${matchCount > 1 ? 's' : ''}.`;
      } else {
        feedback += `Consider addressing specifics like: ${answerKey.slice(0,2).join(', ')}.`;
      }
      // Provide additional context and rationales
      if (pKey === "protective" && matchCount === 0) {
        feedback += " Highlighting strengths/resources shows the path for resilience.";
      }
      if (pKey === "prognosis") {
        feedback += " Prognosis should be evidence-based and realisticâ€”addressing both client motivation and obstacles.";
      }
      if (pKey === "plan") {
        feedback += " Ensure your plan is specific, actionable, and tailored to the presenting problems.";
      }
      return feedback;
    }

    // Initialize random scenario
    function setRandomScenario() {
      let idx = Math.floor(Math.random() * scenarios.length);
      let scenario = scenarios[idx];
      document.getElementById('scenarioBox').innerText = scenario.text;
      document.getElementById('scenarioBox').setAttribute('data-scenario', idx);
      document.getElementById('conceptForm').reset();
      document.getElementById('feedback').classList.add('hidden');
    }

    document.getElementById('randomize').onclick = setRandomScenario;
    window.onload = setRandomScenario;

    // Upon form submission, analyze and provide feedback
    document.getElementById('conceptForm').onsubmit = function(event) {
      event.preventDefault();
      let scenarioIdx = parseInt(document.getElementById('scenarioBox').getAttribute('data-scenario'));
      let keys = scenarios[scenarioIdx].keys;
      let sections = ['presenting', 'predisposing', 'precipitating', 'perpetuating', 'protective', 'prognosis', 'plan', 'personality'];
      let titles = [
        "Presenting Problem", "Predisposing Factors", "Precipitating Factors", "Perpetuating Factors",
        "Protective Factors", "Prognosis", "Plan", "Personality"
      ];
      let feedback = "";
      for (let i = 0; i < sections.length; i++) {
        let userInput = document.getElementById(sections[i]).value;
        feedback += `<strong>${titles[i]}:</strong> ${buildFeedback(sections[i], userInput, keys[sections[i]])}<br>`;
      }
      document.getElementById('feedback').innerHTML = feedback;
      document.getElementById('feedback').classList.remove('hidden');
      window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'});
    }
  </script>
</body>
</html>
